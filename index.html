<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="SegGen">
  <meta name="keywords" content="SegGen">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content="./static/img/logo.png"/>
  <link rel="image_src" href="./static/img/logo.png">
  <link rel="icon"
        type="image/x-icon"
        href="./static/img/logo.png"/>

  <title>
    SegGen: Supercharging Segmentation Models with Text2Mask and Mask2Img Synthesis
  </title>

  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EDF010G6PN');


  </script>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script src="https://unpkg.com/interactjs/dist/interact.min.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" type="text/css" href="./static/slick/slick.css"/>
  <link rel="stylesheet" type="text/css" href="./static/slick/slick-theme.css"/>

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <!-- <a class="navbar-item" href="https://sites.google.com/site/yhrspace/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a> -->

      <!-- <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div> -->
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-2 has-text-centered">
          <img src="static/img/logo.svg" height="100%" alt="logo"/>
        </div>
      </div>
      <div class="container has-text-centered">
        <h1 class="title is-1 publication-title">
          <span style="color: #711c3d"> SegGen: Supercharging Segmentation Models <br>with Text2Mask and Mask2Img Synthesis </span>
        </h1>
        <div class="is-size-5 publication-authors">
          <div class="author-block">
            <a href="https://sites.google.com/site/yhrspace/">Hanrong Ye</a><sup>1</sup>,
          </div>
          <div class="author-block">
            <a href="https://research.adobe.com/person/jason-kuen/">Jason Kuen</a><sup>2</sup>,
          </div>
          <div class="author-block">
            <a href="https://qliu24.github.io/">Qing Liu</a><sup>2</sup>,
          </div>
          <div class="author-block">
            <a href="https://research.adobe.com/person/zhe-lin/">Zhe Lin</a><sup>2</sup>,
          </div>
          <div class="author-block">
            <a href="https://research.adobe.com/person/brian-price/">Brian Price</a><sup>2</sup>,
          </div>
          <div class="author-block">
            <a href="https://www.danxurgb.net/">Dan Xu</a><sup>1</sup>
          </div>
        <div class="is-size-5 publication-authors">
          <span class="author-block"><sup>1</sup>HKUST</span>
          <span class="author-block"><sup>2</sup>Adobe Research</span>
        </div>
        <!-- <div class="is-size-6 publication-authors">
          <span class="author-block"><sup>*</sup>Most work done during internship at Adobe Research</span>
        </div> -->

        <div class="column has-text-centered">
          <div class="publication-links">
            <!-- PDF Link. -->
            <!-- <span class="link-block">
                <a href="https://arxiv.org/pdf/2106.13228.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span> -->
            <span class="link-block">
                <!-- <a href="https://seggenerator.github.io" -->
                <a href="SegGen_arxiv.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
            </span>
            <!-- <span class="link-block">
              <a href="https://github.com/google/hypernerf"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fab fa-github"></i>
                </span>
                <span>Code</span>
                </a>
            </span> -->
            <!-- Dataset Link. -->
            <!-- <span class="link-block">
              <a href="https://github.com/google/hypernerf/releases/tag/v0.1"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="far fa-images"></i>
                </span>
                <span>Data</span>
                </a>
              </span> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <!-- <video id="teaser" autoplay controls muted loop playsinline height="100%">
        <source src="./static/images/teaser.mp4"
                type="video/mp4">
      </video> -->
      <img src="static/img/teaser_coco_website.jpg" height="100%" ></img>
      <h2 class="subtitle has-text">
        <font color="#9e2e23"><b><i>SegGen</i></b></font> not only significatly improve the performance of state-of-the-art segmentation models on standard benchmarks (COCO and ADE20K), 
        but also boost the generalization ability towards challenging images from unseen domain. 
        The three columns on the left are from PASCAL dataset and the three on the right are synthesized by generative model Kandinsky 2.
      </h2>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">

    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified" style="font-size: 20px;">
          <p>
          We propose SegGen, a highly-effective training data generation method for image segmentation, which pushes the performance limits of state-of-the-art segmentation models to a significant extent. 
          SegGen designs and integrates two data generation strategies: MaskSyn and ImgSyn. 
          (i) MaskSyn synthesizes new mask-image pairs via our proposed text-to-mask generation model and mask-to-image generation model, greatly improving the diversity in segmentation masks for model supervision; 
          (ii) ImgSyn synthesizes new images based on existing masks using the mask-to-image generation model, strongly improving image diversity for model inputs. 
          </p>
          <p>
          On the highly competitive ADE20K and COCO benchmarks, our data generation method markedly improves the performance of state-of-the-art segmentation models in semantic segmentation, panoptic segmentation, and instance segmentation. 
          Notably, in terms of the ADE20K mIoU, Mask2Former R50 is largely boosted from 47.2 to 49.9 (+2.7); Mask2Former Swin-L is also significantly increased from 56.1 to 57.4 (+1.3). These promising results strongly suggest the effectiveness of our SegGen even when abundant human-annotated training data is utilized. 
          Moreover, training with our synthetic data makes the segmentation models more robust towards unseen domains. 
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-2">Video</h2>
        <div class="publication-video">
          <iframe width="640" height="480" src="https://www.youtube.com/embed/qzgdE_ghkaI"
                  title="YouTube video player" frameborder="0"
                  allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>


<section class="hero teaser">
  <div class="hero-body">
    <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <h2 class="title is-3 centered">Workflow</h2>
    </div>
    <div class="container is-max-desktop">
      <img src="static/img/framework_website.svg" height="100%" ></img>
      <h2 class="subtitle has-text">
      <b>Workflow of SegGen </b>: We introduce two generative models: a text-to-mask (Text2Mask) generation model and a  mask-to-image( Mask2Img) generation model, based on which we design two approaches for generating new segmentation training samples: MaskSyn and ImgSyn.
      <b>(a)</b> MaskSyn focuses on generating new segmentation masks. It first extracts the caption of the real image as a text prompt and uses it to generate new masks with the Text2Mask model. Then, the new masks and text prompt are fed into the Mask2Img model to produce the corresponding new images.
      <b>(b)</b> ImgSyn focuses on the synthesis of new images. It directly inputs human-labeled masks and text prompts into the Mask2Img model to generate new images.
      </h2>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <!-- <video id="teaser" autoplay controls muted loop playsinline height="100%">
        <source src="./static/images/teaser.mp4"
                type="video/mp4">
      </video> -->
      <img src="static/img/masksyn_0.gif" height="100%" ></img>
      <h2 class="subtitle has-text-centered">
        <b><i>MaskSyn</i></b> synthesize new mask-image pairs. It first generate synthetic segmentation masks with a Text2Mask model, and then synthesize new images with a Mask2Image model.
      </h2>
      <img src="static/img/imgsyn_0.gif" height="100%" ></img>
      <h2 class="subtitle has-text-centered">
        <b><i>ImgSyn</i></b> synthesize new images. It generates new images conditioned on human-annotated segmentation masks with a Mask2Image model.
      </h2>
    </div>
  </div>
</section>

<section class="hero is-dark is-small">
  <div class="hero-body">
    <div class="container has-text-centered">

      <div id="results-carousel" class="carousel results-carousel">

        <div>
          <div class="results-item">
            <image src="static/img/masksyn/ADE_train_00000421_mask.png" ></image>
            <image src="static/img/masksyn/ADE_train_00000421_img.png" ></image>
            <figcaption>Text prompts: "a bed, and a window"</figcaption>
          </div>
        </div>

        <div>
          <div class="results-item">
            <image src="static/img/masksyn/ADE_train_00005483_masksyn_mask_0.png"></image>
            <image src="static/img/masksyn/ADE_train_00005483_masksyn_img_0.png"></image>
            <figcaption>Text prompts: "twin beds"</figcaption>
          </div>
        </div>

        <div>
          <div class="results-item">
            <image src="static/img/masksyn/ADE_train_00002308_img.png" ></image>
            <image src="static/img/masksyn/ADE_train_00002308_mask.png"  ></image>
            <figcaption>Text prompts: "a carpeted room with a desk and chairs"</figcaption>
          </div>
        </div>

      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-three-quarters is-size-5">
          <p>
            Generated mask-image pairs by <b>MaskSyn</b>. Both masks and images are synthesized by our SegGen.
            The synthetic masks are highly diverse.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero is-dark is-small">
  <div class="hero-body">
    <div class="container has-text-centered">
      <div id="results-carousel" class="carousel results-carousel" style="justify-content:center; align-items: center">

        <div>
          <div class="results-item">
            <!-- <video poster="" id="espresso-rgb" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/espresso_rgb.mp4"
                      type="video/mp4">
            </video>
            <video poster="" id="espresso-depth" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/espresso_depth.mp4"
                      type="video/mp4">
            </video> -->
            <!-- <image src="static/img/imgsyn_0.gif" height="135px" style="background-color:#9e2e23;"></image> -->
            <image src="static/img/imgsyn/ADE_train_00000003_img.png" ></image>
            <image src="static/img/imgsyn/ADE_train_00000003_mask.png" ></image>
            <figcaption>Text prompts: "a room with artwork on the walls"</figcaption>
          </div>
        </div>

        <div>
          <div class="results-item">
            <image src="static/img/imgsyn/ADE_train_00001745_img.png"  ></image>
            <image src="static/img/imgsyn/ADE_train_00001745_mask.png" ></image>
            <figcaption>Text prompts: "a woman painting a dog"</figcaption>
          </div>
        </div>

        <div>
          <div class="results-item">
            <image src="static/img/imgsyn/ADE_train_00005061_img.png" ></image>
            <image src="static/img/imgsyn/ADE_train_00005061_mask.png" ></image>
            <figcaption>Text prompts: "a giant inflatable gorilla"</figcaption>
          </div>
        </div>


      </div>

      <div class="columns is-centered has-text-centered">
        <div class="column is-three-quarters is-size-5">
          <p>
            Generated images by <b>ImgSyn</b>. The masks are human-annotated. 
            The synthetic images are realistic and align well with the masks.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


<hr/>

<section class="hero teaser">
  <div class="hero-body">
    <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <h2 class="title is-3 centered">Better Alignment</h2>
      </div>
      <img src="static/img/better_align.jpg" height="100%" ></img>
      <h2 class="subtitle has-text">
        Our synthetic images align better with the human-labeled msks than real images in many cases due to the inaccuracies in human annotations.
        The left 4 samples are from ADE20K and the right 4 are from COCO.
      </h2>
    </div>
  </div>
</section>


<section class="hero teaser">
  <div class="hero-body">
    <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <h2 class="title is-3 centered">Experiments</h2>
      </div>
        <img src="./static/img/exps/table_ade.png"/>
        <img src="./static/img/exps/table_coco_pan.png"/>
        <img src="./static/img/exps/table_ablation.png"/>
      <h2 class="subtitle has-text">
      </h2>
    </div>
  </div>
</section>



<section class="section" id="BibTeX">
  <div class="container content is-max-desktop">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{ye2023seggen,
  title={SegGen: Supercharging Segmentation Models with Text2Mask and Mask2Img Synthesis},
  author={Ye, Hanrong and Kuen, Jason and Liu, Qing and Lin, Zhe and Price, Brian and Xu, Dan},
  year={2023}
}</code></pre>
  </div>
</section>


<section class="section" id="acknowledgements">
  <div class="container content is-max-desktop">
  The website template was adapted from
    <a href="https://hypernerf.github.io/">HyperNerf</a>.
  </div>
</section>



<script type="text/javascript" src="./static/slick/slick.min.js"></script>
</body>
</html>
